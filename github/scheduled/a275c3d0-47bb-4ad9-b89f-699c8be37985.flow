{"id":"gravwell@0.0.1","nodes":{"1":{"id":1,"data":{"macros":{"type":"Array","array_elements":[{"type":"Constant","value":"GRAVWELL_INSTANCE"},{"type":"Constant","value":"GITHUB_ALERT_RECIPIENT"},{"type":"Constant","value":"GITHUB_ALERT_SENDER"}]},"__meta":{"nickname":null,"notes":null,"inputs":[],"values":{"macros":[{"type":{"kind":"string"},"value":"GRAVWELL_INSTANCE"},{"type":{"kind":"string"},"value":"GITHUB_ALERT_RECIPIENT"},{"type":{"kind":"string"},"value":"GITHUB_ALERT_SENDER"}]}},"__disabled":{"type":"Constant","value":false}},"inputs":{"in":{"connections":[]}},"outputs":{"out":{"connections":[{"node":2,"input":"in","data":{}}]}},"position":[144,-384],"name":"MacroGet"},"2":{"id":2,"data":{"template":{"type":"Constant","value":"<html>\n\t<head>\n\t\t<style>\n\t\ttable, th, td {\n\t\tborder: 1px solid black;\n\t\tborder-collapse: collapse;\n\t\tpadding: 5px;\n\t\t}\n\t\tth {\n\t\tbackground-color: #f2f2f2;\n\t\t}\n\t\th2 {\n\t\ttext-align: center;\n\t\tpadding: 0px;\n\t\t}\n\t\tp {\n\t\tpadding-left: 10px;\n\t\tfont-size: 16px;\n\t\t}\n\t\t</style>\n\t</head>\n\t<body>\n\t\t<table style=\"width:100%\">\n\t\t\t<tr>\n\t\t\t\t<th><h1>Alert Details</h1></th>\n\t\t\t</tr>\n\t\t\t<tr><td></td></tr>\n\t\t</table>\n\t\t<table style=\"width:100%\">\n\t\t\t<tr>\n\t\t\t\t<td style=\"width:20%\"><h2>Dispatcher Name:</h2></td>\n\t\t\t\t<td><p>{{ .event.Metadata.Dispatcher.Name }}</p></td>\n\t\t\t</tr>\n\t\t\t<tr>\n\t\t\t\t<td><h2>Flow Name:</h2></td>\n\t\t\t\t<td><p>{{ .flow.Name }}</p></td>\n\t\t\t</tr>\n\t\t\t<tr>\n\t\t\t\t<td><h2>Flow Description:</h2></td>\n\t\t\t\t<td><p>{{ .flow.Description }}</p></td>\n\t\t\t</tr>\n\t\t\t<tr>\n\t\t\t\t<td><h2>Search Start Time:</h2></td>\n\t\t\t\t<td><p>{{ .search.Start }}</p></td>\n\t\t\t</tr>\n\t\t\t<tr>\n\t\t\t\t<td><h2>Search End Time:</h2></td>\n\t\t\t\t<td><p>{{ .search.End }}</p></td>\n\t\t\t</tr>\n\t\t\t<tr>\n\t\t\t\t<td><h2>Search Duration:</h2></td>\n\t\t\t\t<td><p>{{ .search.Duration }}</p></td>\n\t\t\t</tr>\n\t\t\t<tr>\n\t\t\t\t<td><h2>Search Count:</h2></td>\n\t\t\t\t<td><p>{{ .search.Count }}</p></td>\n\t\t\t</tr>\n\t\t\t<tr>\n\t\t\t\t<td><h2>Search Query:</h2></td>\n\t\t\t\t<td><p>{{ .search.Query }}</p></td>\n\t\t\t</tr>\n\t\t\t<tr>\n\t\t\t\t<td><h2>Table Results:</h2></td>\n\t\t\t\t<td>\n\t\t\t\t\t{{- if .tableResults.Data }}\n\t\t\t\t\t<table style=\"width:100%; border-collapse: collapse; font-size:16px;\">\n\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t{{- range .tableResults.Headers }}\n\t\t\t\t\t\t\t<th style=\"border:1px solid black; padding:5px; text-align:left; background-color:#f2f2f2;\">\n\t\t\t\t\t\t\t\t{{ . }}\n\t\t\t\t\t\t\t</th>\n\t\t\t\t\t\t\t{{- end }}\n\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t{{- range .tableResults.Data }}\n\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t{{- range . }}\n\t\t\t\t\t\t\t<td style=\"border:1px solid black; padding:5px; text-align:left;\">\n\t\t\t\t\t\t\t\t{{ . }}\n\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t{{- end }}\n\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t{{- end }}\n\t\t\t\t\t</table>\n\t\t\t\t\t{{- else }}\n\t\t\t\t\t<p>No table results returned.</p>\n\t\t\t\t\t{{- end }}\n\t\t\t\t</td>\n\t\t\t</tr>\n\t\t\t<tr>\n\t\t\t\t<td>\n\t\t\t\t\t<h2>Link to Results</h2>\n\t\t\t\t</td>\n\t\t\t\t<td>\n\t\t\t\t\t<p><a href=\"https://localhost:8080/search/{{ .search.ID }}\" target=\"_blank\">\n\t\t\t\t\t\tOpen Search\n\t\t\t\t\t</a></p>\n\t\t\t\t</td>\n\t\t\t</tr>\n\t\t</table>\n\t</body>\n</html>"},"name":{"type":"Constant","value":"alertTemplate"},"__meta":{"nickname":null,"notes":null,"inputs":[],"values":{"template":{"type":{"kind":"string:longtext"},"value":"<html>\n\t<head>\n\t\t<style>\n\t\ttable, th, td {\n\t\tborder: 1px solid black;\n\t\tborder-collapse: collapse;\n\t\tpadding: 5px;\n\t\t}\n\t\tth {\n\t\tbackground-color: #f2f2f2;\n\t\t}\n\t\th2 {\n\t\ttext-align: center;\n\t\tpadding: 0px;\n\t\t}\n\t\tp {\n\t\tpadding-left: 10px;\n\t\tfont-size: 16px;\n\t\t}\n\t\t</style>\n\t</head>\n\t<body>\n\t\t<table style=\"width:100%\">\n\t\t\t<tr>\n\t\t\t\t<th><h1>Alert Details</h1></th>\n\t\t\t</tr>\n\t\t\t<tr><td></td></tr>\n\t\t</table>\n\t\t<table style=\"width:100%\">\n\t\t\t<tr>\n\t\t\t\t<td style=\"width:20%\"><h2>Dispatcher Name:</h2></td>\n\t\t\t\t<td><p>{{ .event.Metadata.Dispatcher.Name }}</p></td>\n\t\t\t</tr>\n\t\t\t<tr>\n\t\t\t\t<td><h2>Flow Name:</h2></td>\n\t\t\t\t<td><p>{{ .flow.Name }}</p></td>\n\t\t\t</tr>\n\t\t\t<tr>\n\t\t\t\t<td><h2>Flow Description:</h2></td>\n\t\t\t\t<td><p>{{ .flow.Description }}</p></td>\n\t\t\t</tr>\n\t\t\t<tr>\n\t\t\t\t<td><h2>Search Start Time:</h2></td>\n\t\t\t\t<td><p>{{ .search.Start }}</p></td>\n\t\t\t</tr>\n\t\t\t<tr>\n\t\t\t\t<td><h2>Search End Time:</h2></td>\n\t\t\t\t<td><p>{{ .search.End }}</p></td>\n\t\t\t</tr>\n\t\t\t<tr>\n\t\t\t\t<td><h2>Search Duration:</h2></td>\n\t\t\t\t<td><p>{{ .search.Duration }}</p></td>\n\t\t\t</tr>\n\t\t\t<tr>\n\t\t\t\t<td><h2>Search Count:</h2></td>\n\t\t\t\t<td><p>{{ .search.Count }}</p></td>\n\t\t\t</tr>\n\t\t\t<tr>\n\t\t\t\t<td><h2>Search Query:</h2></td>\n\t\t\t\t<td><p>{{ .search.Query }}</p></td>\n\t\t\t</tr>\n\t\t\t<tr>\n\t\t\t\t<td><h2>Table Results:</h2></td>\n\t\t\t\t<td>\n\t\t\t\t\t{{- if .tableResults.Data }}\n\t\t\t\t\t<table style=\"width:100%; border-collapse: collapse; font-size:16px;\">\n\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t{{- range .tableResults.Headers }}\n\t\t\t\t\t\t\t<th style=\"border:1px solid black; padding:5px; text-align:left; background-color:#f2f2f2;\">\n\t\t\t\t\t\t\t\t{{ . }}\n\t\t\t\t\t\t\t</th>\n\t\t\t\t\t\t\t{{- end }}\n\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t{{- range .tableResults.Data }}\n\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t{{- range . }}\n\t\t\t\t\t\t\t<td style=\"border:1px solid black; padding:5px; text-align:left;\">\n\t\t\t\t\t\t\t\t{{ . }}\n\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t{{- end }}\n\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t{{- end }}\n\t\t\t\t\t</table>\n\t\t\t\t\t{{- else }}\n\t\t\t\t\t<p>No table results returned.</p>\n\t\t\t\t\t{{- end }}\n\t\t\t\t</td>\n\t\t\t</tr>\n\t\t\t<tr>\n\t\t\t\t<td>\n\t\t\t\t\t<h2>Link to Results</h2>\n\t\t\t\t</td>\n\t\t\t\t<td>\n\t\t\t\t\t<p><a href=\"https://localhost:8080/search/{{ .search.ID }}\" target=\"_blank\">\n\t\t\t\t\t\tOpen Search\n\t\t\t\t\t</a></p>\n\t\t\t\t</td>\n\t\t\t</tr>\n\t\t</table>\n\t</body>\n</html>"},"name":{"type":{"default":"templateOutput","kind":"string"},"value":"alertTemplate"}}},"__disabled":{"type":"Constant","value":false}},"inputs":{"in":{"connections":[{"node":1,"output":"out","data":{}}]}},"outputs":{"out":{"connections":[{"node":3,"input":"in","data":{}}]}},"position":[368,-384],"name":"Template"},"3":{"id":3,"data":{"from":{"type":"Variable","value":"GITHUB_ALERT_SENDER"},"to":{"type":"Array","array_elements":[{"type":"Variable","value":"GITHUB_ALERT_RECIPIENT"}]},"cc":{"type":"Array","array_elements":[]},"bcc":{"type":"Array","array_elements":[]},"subject":{"type":"Variable","value":"event.Metadata.AlertName"},"body":{"type":"Variable","value":"alertTemplate"},"attachment":{"type":"Array","array_elements":[]},"__meta":{"nickname":"Email Recipient","notes":null,"inputs":[],"values":{"from":{"type":{"kind":"variable"},"value":"GITHUB_ALERT_SENDER"},"to":[{"type":{"kind":"variable"},"value":"GITHUB_ALERT_RECIPIENT"}],"cc":[],"bcc":[],"subject":{"type":{"kind":"variable"},"value":"event.Metadata.AlertName"},"body":{"type":{"kind":"variable"},"value":"alertTemplate"},"attachment":[]}},"__disabled":{"type":"Constant","value":false}},"inputs":{"in":{"connections":[{"node":2,"output":"out","data":{}}]}},"outputs":{"out":{"connections":[]}},"position":[592,-384],"name":"Email"}}}
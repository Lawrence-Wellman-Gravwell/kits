tag=$SYSMON winlog Provider=="Microsoft-Windows-Sysmon" EventID==22 QueryName |
diff TIMESTAMP by QueryName |
require -s diff |
stats mean(diff) stddev(diff) count by QueryName |
eval (stddev < mean && count > 2) |
eval setEnum("r", stddev/mean) |
eval setEnum("Duration", toDuration(mean)) |
sort by r asc |
table QueryName Duration count
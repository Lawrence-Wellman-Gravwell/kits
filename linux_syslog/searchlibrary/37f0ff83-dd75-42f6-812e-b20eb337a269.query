@successful{tag=$SYSLOG words Accepted | syslog Appname==sshd Hostname Message | regex -e Message "Accepted (?P<method>\S+) for (?P<user>\S+) from (?P<ip>\S+)" | unique method user ip Hostname | table user ip Hostname}; tag=$SYSLOG words authenticating user | syslog Appname==sshd Hostname Message | regex "(Disconnected from|Connection closed by) authenticating user (?P<failed_user>\S+) (?P<failed_ip>\S+)" | alias Hostname failed_hostname | lookup -s -r @successful failed_ip ip (Hostname as successful_hostname user as successful_user) | unique failed_ip failed_hostname failed_user successful_hostname successful_user | table failed_ip failed_hostname failed_user successful_hostname successful_user
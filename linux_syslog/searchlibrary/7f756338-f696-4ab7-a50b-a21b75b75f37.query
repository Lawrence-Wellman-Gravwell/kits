@failed{tag=$SYSLOG syslog Appname==sshd Message Hostname | regex "(Invalid user|Connection closed by authenticating user)" | stats count by Hostname | table Hostname count}; tag=$SYSLOG words Accepted | syslog Appname==sshd Message Hostname | regex -e Message "Accepted (?P<method>\S+) for (?P<user>\S+) from (?P<ip>\S+)" | stats count as successes by Hostname | lookup -r @failed Hostname Hostname count as failures | eval if successes > 0 { setEnum("ratio", toInt(failures / successes)+":1") } | table Hostname failures successes ratio